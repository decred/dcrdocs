# Υβριδικό Σχέδιο

---

Η κύρια αντίθεση με το ακολούθα-τον-satoshi σχήμα που περιγράφτηκε προηγουμένως[^1] είναι ένα νέο σύστημα λοταρίας στο οποίο πρώτα πρέπει να γίνει η αγορά των εισιτηρίων και στη συνέχεια να περιμένουν μια περίοδο ωριμότητας πριν να επιλεγούν και δαπανηθούν. Η επιλογή των εισιτηρίων για ένα μπλοκ εκτελείται λεξικογραφικά από μια ώριμη συγκέντρωση εισιτηρίων βασισμένη στην ψευδοτυχαιότητα η οποία περιέχεται στην κεφαλίδα του μπλοκ. Επειδή η χειραγώγηση αυτής της ψευδοτυχαιότητας είναι δύσκολη σε ένα σύστημα PoW, η χειραγώγηση της επιλογής εισιτηρίων σχετίζεται με ένα θεμελιώδες κόστος για τον εξορυκτή PoW. Η επιλογή των εισιτηρίων για μια χρονική περίοδο μπορεί να περιγραφεί από μια συνάρτηση πιθανότητας πυκνότητας παρόμοια με την πιθανότητα λήψης ενός μπλοκ σε PoW με σταθερό ρυθμό hash με την πάροδο του χρόνου σε μια σταθερή δυσκολία[^2], αποδίδοντας μια πιθανότητα κατανομής με έναν τρόπο περίπου ίσο με το μισό μέγεθος της συγκέντρωσης εισιτηρίων. Η τιμή αγοράς εισιτηρίου ρυθμίζεται από μια νέα δυσκολία stake η οποία καθορίζεται από τον εκθετικά σταθμισμένο μέσο όρο των εισιτηρίων που αγοράστηκαν και από το μέγεθος της ώριμης συγκέντρωσης εισιτηρίων σε προηγούμενα μπλοκ.

Η επικύρωση των μπλοκ PoW εξηγείται από τα ακόλουθα βήματα:

1. Ένα μπλοκ εξορύσσεται από έναν εξορυκτική PoW, ο οποίος επιλέγει τις συναλλαγές που θα βάλει μέσα του. Οι συναλλαγές που σχετίζονται με το σύστημα stake εισάγονται στο σύνολο UTXO.
2. Οι εξορυκτικές PoS ψηφίζουν το μπλοκ με την παραγωγή μιας συναλλαγής ψήφου από το εισιτήριό τους. Η ψήφος επιτρέπει το χτίσιμο ενός μπλοκ πάνω από το προηγούμενο μπλοκ και επιλέγει εάν το προηγούμενο δέντρο συναλλαγής είναι έγκυρο ή όχι.
3. Ένας άλλος εξορυκτής ξεκινάει να χτίζει ένα μπλοκ, εισάγοντας τις ψήφους των PoS εξορυκτών. Η πλειοψηφία των ψήφων πρέπει να συμπεριληφθεί στο επόμενο μπλοκ έτσι ώστε το μπλοκ αυτό να γίνει αποδεκτό από το δίκτυο. Από τις συναλλαγές ψηφοφορίας σε αυτό το νέο μπλοκ, ο εξορυκτής PoW ελέγχει μια σημαία για να δει αν ο εξορυκτής PoS υποδεικνύει ότι το κανονικό δέντρο συναλλαγών του μπλοκ ήταν έγκυρο. Αυτές οι σημαίες ψηφοφορίας είναι ταυτοποιημένες και βασισμένες στην πλειοψηφία των ψήφων, μια σημαία bit έχει οριστεί σε αυτό το μπλοκ για να υποδηλώσει εάν το κανονικό δέντρο συναλλαγών του προηγούμενου μπλοκ είναι έγκυρο.
4. Βρέθηκε ενα nonce που ικανοποιεί τη δυσκολία δικτύου και το μπλοκ εισάγεται στο blockchain. Εάν το δέντρο συναλλαγής του προηγούμενου μπλοκ έχει επικυρωθεί, εισάγει τις συναλλαγές αυτές στο σύνολο UTXO. Πήγαινε στο 1.

Για να αποθαρρυνθεί η χειραγώγηση των περιλαμβανομένων ψήφων, εφαρμόζεται μια γραμμική επιβολή κυρώσεων στο τρέχον μπλοκ αν αποτύχουν να συμπεριλάβουν όλες τις συναλλαγές ψηφοφορίας στο μπλοκ τους. Η "μαλακή" ποινή της ακύρωσης του προηγούμενου δέντρου συναλλαγών βοηθά στην αποτροπή της απόρριψης εργασίας, η οποία είναι απαραίτητη για την ασφάλιση του συστήματος, και κάνει την υπόθεση ότι το επόμενο μπλοκ θα ληφθεί από έναν εξορυκτή ο οποίος δεν ενδιαφέρεται να διατηρήσει την επιδότηση του προηγούμενου μπλοκ υπέρ του δικού τους. Ακόμα και στην περίπτωση που αυτό δεν ισχύει, ένας κακόβουλος εξορυκτής με υψηλό συντελεστή hash θα χρειαστεί τουλάχιστον \((\text{number for majority}/2)+1\) ψήφους υπέρ του προηγούμενου δέντρου συναλλαγών μπλοκ προκειμένου να δημιουργήσει ένα μπλοκ που του δίνει οποιαδήποτε επιδότηση από το προηγούμενο μπλοκ.

Οι σημαίες bit προστίθενται ρητά τόσο στην κεφαλίδα του μπλοκ όσο και στις ψηφοφορίες, έτσι ώστε οποιοσδήποτε ανθρακωρύχος να μπορεί εύκολα να ψηφίσει σε νέα hard ή soft forks.

---

## <i class="fa fa-book"></i> Αναφορές 

[^1]: Bentov I., Lee C., Mizrahi A., Rosenfeld M. 2014. [Proof-of-activity: Extending Bitcoin's proof-of-work via proof-of-stake](https://decred.org/research/bentov2014.pdf).
[^2]: Nakamoto S. 2008. [Bitcoin: A peer-to-peer electronic cash system](https://decred.org/research/nakamoto2008.pdf).
