# Подписи по схеме Шнорра 

---

Для Bitcoin были предложены подписи по схеме Шнорра. Они также широко используются в других криптовалютах, таких как Nxt и CryptoNote coins. В простейшем случае криптосистема ECDSA со Schnorr-подписью может быть описана следующим образом:

1. \(y = xG\) где \(y\) является точкой открытого ключа на кривой, \(x\) является частным скаляром, \(G\)  является генератором кривой.
2. \(r = kG\) где \(r\) точка на кривой, полученная в результате умножения \(k\), nonce скаляра, на генератор.
3. \(h = H(M || r)\) где \(H\) защищенная хэш-функция, \(M\) iэто сообщение (обычно 32 байтовый хеш) и \(r\) закодированная точка, описанная ранее. \(||\) обозначает конкатенацию.
4. \(s = k - hx\) где \(s\) скаляр, обозначаемый из \(k - hx\).
5. Подпись \((r,s)\), а верификация - просто \(H(M || r) == hQ + sG\).

В случае, приведенном выше, умножения на заглавную букву (например, \(kG\)) являются умножениями точек на скаляр и поэтому всегда приводят к точке на кривой. Сложение этих точек приводит к еще одной точке. Сложение и умножение скаляров друг на друга - это то же самое, что и обычное умножение, которое Вы бы произвести с любым целым числом. Важно отметить, что умножение точки на скаляр рассматривается как необратимый шаг, так как вычисление скаляра из новой точки по умолчанию считается задачей дискретного логарифмирования.

Из сказанного ясно, что \(r\) точка на кривой, а \(s\) скаляр. Рассмотрим группу владельцев подписи, представленную \(x_{sum} = x_1 + ... + x_n\) с nonces \(k_{sum} = k_1 + ... + k_n\). Открытый ключ для частной скалярной суммы будет: \(y = x_{sum} G\). Подпись для этих сумм (от всех участников группы) будет: \(r' = k_{sum} G s' = k_{sum} - h x_{sum}\). Чтобы сгенерировать эту подпись, всем участникам требуется поделиться своим личным ключом и nonces заранее. Очевидно, мы хотим избежать этого, поэтому создаем частичную подпись для каждого из участников. \(r_n = k_1 G + ... + k_n G = r'\) (сумма открытых nonce точек, которые участники могут свободно публиковать в индивидуальном порядке) \(s_n = k_n - h x_n\). Подставляя это в общие формулы для сигнатур и используя точечное или скалярное сложение: \(r = r_n = r'\) (то же, что и выше) \(s = s_1 + ... + s_n = s'\) (простое скалярное сложение; верно, что \((k_1 - h x_1) + ... + (k_n - h x_n) = s_1 + ... + s_n = s')\).Выполнение m-of-n подписи является нетривиальным. Было высказано предложение, чтобы для таких случаев использовалось дерево Меркла, содержащее все возможные суммы открытых ключей для \(log(n)\) участников, создавая подпись размера [28].

---

## <i class="fa fa-book"></i> Ссылки 

[^1]: Wuille P. 2015. [Tree signatures: Multisig on steroids using tree signatures](https://decred.org/research/wuille2015.pdf).
