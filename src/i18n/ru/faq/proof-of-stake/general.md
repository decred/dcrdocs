# <i class="fa fa-ticket"></i> Общие вопросы PoS

---

#### 1. Что такое система Proof-of-Stake Decred? 

Система Proof-of-Stake (PoS) позволяет держателям Decred иметь право голоса в управлении валютой. Она направлена на то, чтобы дать пользователям право голоса наряду с майнерами.
Для участия пользователи могут приобрести "тикеты", которые входят в лотерейный пул. Каждый блок 5 тикетов выбирается из тикет-пула PoS. Если хотя бы 3 из них подтверждают ранее добытый блок, 
новонайденный блок добавляется в блокчейн, и платится как майнерам, так и владельцам ставок PoS stakers. Если блок не подтвержден PoS stakers, PoW-майнерам не выплачивается, но PoS stakers получают выплату. Это делается, чтобы поощрить PoW-майнеров "майнить" в соответствии с пожеланиями PoS stakers.

Эта система PoS имеет ряд преимуществ, позволяющих решить проблемы, с которыми сталкиваются системы, основывающиеся только для PoW. Например, поскольку PoS stakers должны подтверждать блоки, которые "добывают" PoW-майнеры, PoW-майнеры не могут самостоятельно решить изменить правила сети (атака 51%). Или, когда Decred производит крупные изменения (hardforks), старая, более короткая, цепь быстро исчезнет из-за неподтверждения PoS-составляющей
цепи.

Система PoS вознаграждает участников за их ставки. Каждый блок Decred имеет компонент для вознаграждения PoS (PoS reward), который будет распределяться по каждому тикету, выбранному для голосования в этом блоке. Система разработана таким образом, чтобы средний период для выбора тикета составлял 28 дней. Если тикет не был выбран после 40960 блоков (чуть меньше 5 месяцев), он будет аннулирован (revoked) системой. DCR, использованные для покупки
тикета, возвращаются независимо от того, голосует он или нет.

Еще одна интересная особенность, возможность для которой создает данная система PoS - возможность голосовать по повестке дня (agenda). Поскольку подтверждение блока может рассматриваться как голосование (vote), добавление дополнительных votebit-компонентов голосования в тикет, система может отслеживать и подсчитывать голоса по целой серии блоков. Подобные голосования могут быть о чем угодно.

Купив тикет, любой, кто имеет DCR,  может участвовать в системе Proof-of-Stake Decred.

---

#### 2. Что такое тикеты? 

Тикет - это жетон (токен), который Вы приобретаете для участия в системе PoS. Вы можете купить тикеты через интерфейс командной строки dcrctl или через GUI, например, Paymetheus[^1] или Decrediton. Всякий раз, когда Вы покупаете тикет, Вы оплачиваете текущую стоимость тикета (current ticket price) и взнос\комиссию за тикет (ticket fee), используя Ваши DCR. Когда тикет куплен, он переходит во временный пул памяти (mempool). Для каждого блока могут быть добыты 20 тикетов, и они отбираются дл "добычи" на основе их взноса за килобайт (fee per kilobyte). Поскольку "добыть" в блоки по заданной цене можно только ограниченное количество тикетов (2880), может возникнуть конкуренция за то, чтобы именно данные тикеты были "добыты". В этом случае
Вы можете увеличить fee, которую Вы готовы заплатить, чтобы Ваш или Ваши тикеты были "добыты". Как только Ваш тикет добыт, он переместится из текущего "allmempool" в пул "незрелых" тикетов. После 256 блоков
(около 20 часов) он "созревает" и заходит в пул "живых" тикетов (live ticket pool), где он может быть взят для голосования.

---

#### 3. Нужно ли постоянно подключаться к сети для участия в PoS? 

Кошелек должен быть онлайн 24/7, чтобы откликнуться на голосование, если выбран один из Ваших тикетов. Существует два основных способа сделать это: индивидуальный кошелек (solo staking wallet), который Вы устанавливаете и постоянно держите онлайн, или же Вы
можно воспользоваться стейк-пулом [stake pool](/mining/proof-of-stake.md#solo-mining-or-pool-mining). Стейк-пул - это, по сути своей, кошелек, управляемый сообществом, которому Вы можете передать права на голосование своих тикетов, и пул будет
голосовать от Вашего имени за небольшой процент вознаграждения PoS (PoS reward).

Важно отметить, что Вы передаете пулу только право голосовать, а не свои фактические средства. Стейк-пул ни в коем случае не имеет доступа к Вашим средствам.

---

#### 4. Что такое "стоимость тикета" (ticket price)? 

Стоимость тикетов определяется алгоритмом, который направлен на сохранение размера пула тикетов, который представляет собой общее количество тикетов в общем тикет-пуле системы PoS в границах заданного размера приблизительно в 40960 тикетов.
Стоимость тикета будет повышаться или понижаться в соответствии со спросом на тикеты и количеством тикетов, которые в настоящее время находятся в пуле.

Каждые 144 блока алгоритм корректирует стоимость тикета. Это называется окном покупки (buying window). Каждый блок может содержать 20 недавно приобретенных тикетов. Это означает, что в каждом окне покупки максимум 2880 тикетов
может быть добавлено в тикет-пул системы PoS.

Стоимость тикетов всегда возмещается, без разницы, проголосовал ли Ваш тикет, пропустил голосование (missed)или у него закончился срок действия (expired).

---

#### 5. Какие комиссионные сборы (fees)? 

Система PoS использует два типа fees, txfee (также известная как 'split' fee, сплит) и ticketfee.
	
Txfee - это комиссия, которую Вы платите сети за обработку транзакции на покупку тикета. Эта fee устанавливается низкой по умолчанию (0,01 DCR / kB) и ее не следует менять.
Ticketfee - это комиссия или взнос за тикет, которую Вы платите, если Ваш тикет "добыт". Эта fee мотивирует PoW-майнеров "добыть" Ваш тикет и добавить его в тикет-пул.

В случае, если окно покупки заполнено, то есть покупается больше тикетов, чем доступно для "добычи" во время этого окна, то будет использоваться ticketfee, чтобы определить, какие именно тикеты будут помещены в
тикет-пул. Майнеры PoW выберут тикеты с самой высокой ticketfee.

Fees рассчитываются в DCR за килобайт. Поскольку размер тикета составляет около 300 (solo) или 540 (pool) байтов, фактические fees, которые Вы платите, будут ниже, чем Вы установили как конкретный размер fee (specific fee amount).

Как txfees, так и ticketfees не будут возвращены, когда тикет проголосовал, истек или пропустил голосование.

За возврат средств на Ваш кошелек после того, как тикет проголосовал или был аннулирован, комиссионные не платятся.

---

#### 6. Что такое пул ставок (стейк-пул, stake pool)? 

Стейк-пул эквивалентен майнинг-пулу, но в системе PoS. С помощью параметров вашего Decred-кошелька Вы можете передать свое право на голосование в стейк-пул. Если Ваш тикет выбран для голосования,
стейк-пул проголосует за Вас, и Вы получите будете вознаграждение PoS (PoS-reward) за вычетом комиссионных пула (stake pool fee) (обычно 4-5%). В отличие от майнинг-пулов, PoS-reward не разделяется между пользователями стейк-пула. Reward полностью идет владельцу тикета.

Стейк-пул позволит Вам покупать тикеты, но не держит Ваш собственный кошелек онлайн и разблокированным. Важно отметить, что Ваши средства никогда не покидают Ваш кошелек. Вы ничего не отправляете в пул,
только даете ему право голосовать от Вашего имени. Стейк-пул не имеет доступа к Вашим средствам. 

Стейк-пулы обычно задействуют принцип multi-wallet избыточности, имея множество кошельков, физически распределенных по всему миру. Это означает меньшую возможность пропустить голосование из-за отключения одного из кошельков.
Это также сокращает время задержки между кошельком и сетью, что может уменьшить вероятность пропущенного голосования.

---

#### 7. Что происходит с моими средствами, когда я покупаю тикет? 

Средства, используемые для покупки тикета, блокируются до тех пор, пока тикет не будет выбран для голосования или истечет. Они не могут покинуть кошелек и появятся в разделе "lockedbytickets" Вашего кошелька.
Если Ваш тикет выбран для голосования, Вам будет возвращена полная сумма, уплаченная за тикет, и выплачен PoS reward.

Единственные расходы на использование этой системы - это установленные Вами fees. Txfee будет взиматься за транзакцию Вашего тикета через сеть. Ticketfee будет взиматься за включение в
тикет-пул и  выплачиваться PoW-майнерам. Если Ваш тикет не добыт, плата не взымается, поскольку транзакция в сети не проводилась.

В случае, если Ваш тикет не выбран для голосования по прошествии 40960 блоков (около 4 месяцев), система аннулирует Ваш тикет, и decred, которые Вы заплатили за него (минус fees), будут переведены обратно в Ваш кошелек. 

---

#### 8. Каковы шансы на голосование для моего тикета? 

Система PoS в Decred использует распределение Пуассона для определения возможности голосования тикета в произвольный момент времени. Учитывая заданный размер пула в 40960 тикетов, у любого тикета есть 50% шанс проголосовать
в течение 28 дней и 99,5% шанс проголосовать до истечения срока действия. Обратите внимание, что эти значения будут изменяться с размером пула.


---

#### 9. Что такое Proof-of-Stake голосование? 

Поскольку подтверждение блока, производимое системой PoS, работает, как система голосования, ее также можно использовать для голосования по другим вопросам.

Будучи выбраными для подтверждения блока, тикеты голосуют за то, одобрить или нет "добытый" ранее блок. Требуется, чтобы 3 из 5 проголосовали "за".

После добавления в тикеты еще одного параметра, который не мешает утверждению "добытых" блоков, система может отслеживать количество тикетов, применяя этот параметр к некоторому количеству блоков. Вы можете установить данный параметр в своем кошельке в любое время до того, как тикет проголосовал. 

Например, Вы можете выбрать цвет Вашего тикета, красный или синий, выставить этот параметр, и система на следующие 1000 блоков будет рассчитывать, сколько там красных и сколько синих тикетов. Возможно, там есть 3000 красных тикетов, 1500 синих тикетов и 500 не выбравших цвет.

Если заменить параметр "красный или синий" опцией "да или нет", в наличии появляется система голосования, которая со временем может подсчитывать голоса. Используя систему голосования PoS, любой держатель DCR, может голосовать по вопросам, поставленным на повестку дня (agenda).

Эта система голосования может использоваться для любых общеорганизационных вопросов. Для Decred наиболее показательным ее использованием будет являться голосование по hardforks, техническим изменениям в процессе работы валюты. Некоторые примеры:

- Увеличение максимального размера блока.
- Изменение алгоритма, который PoS использует для определения стоимости тикета.
- Vote on major new features for the currency (e.g. lightning network, enhanced privacy).
- Изменение PoW-алгоритма.
- Pretty much anything the community decides would be in the best interest of the currency.

В настоящее время разрабатывается платформа для подачи и обсуждения повестки голосования в сообществе.

---

#### 10. Что такое hardfork голосование? 

Как и любой другой криптовалюте, Decred может в какой-то момент понадобиться hardfork (технические изменения).

Одним из вопросов повестки дня, поставленным в системе голосования PoS, может быть hardfork. Если такой вопрос будет вынесен, то новая версия исходного кода Decred будет включать в себя hardfork, но hardfork не будет активирован, пока система PoS не проголосовала за него.

Для начала голосования за hardfork необходимо, чтобы выполнялись два критических условия:

- Во-первых, 75% PoW-майнеров должны обновиться до последней версии текущей версии блока сети. Эта проверка охватывает последних 1000 блоков.
- Во-вторых, 75% PoS-майнеров должны обновиться до последней версии. Эта проверка охватывает последних 2016 блоков.

Как только эти проверки будут выполнены, начнется процесс голосования. В тикетах можно установить дополнительный параметр yes (да) / no (нет) / abstain (воздержаться). Вы делаете это в своем кошельке перед тем, как тикет голосует. Тикеты, отмеченные как воздержавшиеся, не будут учитываться в общей сумме голосов.

Затем система PoS начинает подсчет тикетов с этими параметрами, установленными на заданное количество блоков. Если за этот интервал количество голосов "да" составляет 75% и более, голосование осуществилось. Период блокировки определенного количества блоков начнется до того, как hardfork вступит в силу, поэтому у каждого есть возможность обновиться и не быть исключенным из сети во время hardfork.

Поскольку код для hardfork уже вшит в текущую версию Decred, разработчикам нет необходимости вмешиваться, а большинству PoW- и PoS-майнеров не нужно будет обновляться, когда решение будет принято. Если голосование по hardfork проходит, он будет реализован автоматически после периода блокировки.

Голосование по hardfork может потерпеть неудачу во множестве моментов. Голосование может не начаться, если PoW-майнеры или PoS-майнеры не обновятся. После этого, также порог 75% голосов может быть не достигнут.

В случае провала голосования начнется новый раунд с начала процесса. Это означает проверку того, обновились ли PoW-майнеры, обновились ли PoS-майнеры, а затем еще один период подсчета голосов. Это будет продолжаться в течение определенного количества раундов, после чего, если голосование не будет принято, данный вопрос повестки дня будет отложен.

---

#### 11. Подвержен ли PoS влиянию крупных бирж, оперирующих decred своих клиентов? 

Количество decred, которое имеет человек (или биржа) не имеет никакого значения для PoS. Это количество тикетов, которые у Вас есть. Средства, используемые для покупки тикетов, блокируются, пока тикеты, которые они купили, не проголосуют. Это означает, что
decred, задействованные в PoS, в действительности, не могут быть куда-либо переданы. Для того, чтобы биржа могла использовать decred своих клиентов для голосования, они должны были бы вывести их из кошельков и заблокировать их на срок до 5 месяцев. Люди
бы заметили, что их баланс изменился (decred, заблокированные в PoS, не показываются, как "расходуемые" (spendable). Также они не смогли бы снимать средства, поэтому биржи испытывали бы значительную потерю ликвидности.

Также существует жесткий лимит в 20 тикетов на каждый блок, поэтому никакая биржа не сможет наполнить пул скорее, чем таким образом.

Наконец, в программе есть ограничитель на общее количество тикетов в пуле. Каждые 144 блока (2880 тикетов), стоимость тикета корректируется в зависимости от количества тикетов в пуле и стоимости, с которой новые тикеты
были добавлены во время последнего окна. Иногда стоимость тикетов бывает настолько высока, что даже биржа не смогла бы купить много. И помните, что даже если бы они это сделали, их DCR заблокированы, поэтому они
не могут купить еще, когда стоимость снова упадет.

---

#### 12. Is PoS susceptible to influence from large balance holders such as the original developers? 

Здесь применяются вышеуказанные ограничения размера пула. Это препятствует одному человеку / группе наполнить пул PoS большим количеством собственных тикетов. Даже если они выкупили весь пул (с огромными fees), самое 
большое, что они могут получить - это около 4000 тикетов (основываясь на предыдущих "окнах" тикетов, где около 30DCR, обычно подымаются до 100 в следующем "окне", и максимум после этого часто превышает 300). Таким образом, 
владельцы крупного баланса могут выкупить 2 окна. "Окно" на 30 будет составлять 86 400 DCR, а затем следующее на 100 будет 288 000 DCR. Так что купить 5760 тикетов стоило бы 374 400DCR. С заданным размером пула в 40960 тикетов, 374400 DCR предоставит Вам около 14% всех тикетов.

Now the holder could wait a couple of days for the price to drop then start buying back up again. Except that most of their funds will be locked in the ones they bought earlier (although some will have voted) so their buying power for the new window is greatly reduced. But let's say they have super capital and bought all the decred on all exchanges. So they are able to buy another two windows and replace those tickets that voted and were successful in buying all the tickets (at very high fees and/or prices). Let's say that takes them to about 25% of the tickets.

Тикеты для блока выбираются случайным распределением. Для того, чтобы заставить голосование проходить определенным образом, Вам понадобится 3 из 5 голосов за данный блок, что составляет 60%. Даже при огромных расходах капитала
они пока менее, чем на полпути. И результат голосования не определяется единственным блоком, поэтому Вам потребуется 60% из 75% блоков в период голосования.

И ТУТ Вам все еще нужны PoW-майнеры для подтверждения голосов. Если они думают, что кто-то пытается обойти систему, они могут решить не подтверждать блоки.

Таким образом, в принципе, это практически невозможно, даже если у одного человека есть ОГРОМНЫЙ процент DCR.

But then we come to the stake pools. Stake pools, while not having access to any of their users' funds, do have the ability to change votes on tickets assigned to them. This is why it is suggested that when joining a stake pool, people don't just go for the largest one. Decred is short for 'decentralised credit' so part of the spirit of PoS is ensuring that the PoS stake pools don't get too large in relation to the others. However, even the largest at almost 20% would still only get on average one vote per block.

Таким образом, Decred был специально разработан для минимизации влияния как крупных PoW- и PoS-пулов, так и отдельных лиц (включая разработчиков) с крупными резервами. 

## <i class="fa fa-book"></i> Ссылки 

[^1]: [Paymetheus Ticket Purchasing Guide](/getting-started/user-guides/using-paymetheus.md#-purchase-tickets-tab)
