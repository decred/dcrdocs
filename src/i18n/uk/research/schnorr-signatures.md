# Підписи по схемі Шнорра (Schnorr Signatures) 

---

Для Bitcoin були запропоновані підписи по схемі Шнорра. Вони також широко використовуються в інших криптовалютах, таких як Nxt та CryptoNote coins. У найпростішому випадку криптосистема ECDSA зі Schnorr-підписом може бути описана таким чином:

1. \(y = xG\) де \(y\) точка відкритого ключа на кривій, \(x\) приватний скаляр, \(G\) це генератор кривої.
2. \(r = kG\) де \(r\) очка на кривій, отримана в результаті множення \(k\), nonce скаляра, на генератор.
3. \(h = H(M || r)\) де \(H\) захищена хеш-функція, \(M\) це повідомлення (як правило, 32 байтовий хеш), а \(r\) закодована точка, описана раніше. \(||\) позначає конкатенацію.
4. \(s = k - hx\) де \(s\) скаляр, позначуваний з \(k - hx\).
5. Підпис \((r,s)\), а верифікація просто \(H(M || r) == hQ + sG\).

У вищенаведеному випадку, множення на велику літеру (наприклад., \(kG\)) є множенням точок на скаляр, і тому завжди призводить до точки на кривій. Додавання цих точок приводить до ще однієї точки. Додавання та множення скалярів між собою - це те ж саме, що і звичайне множення, яке Ви могли б виконати з будь-яким цілим числом. Важливо зазначити, що множення точки на скаляр розглядається як незворотній крок, оскільки розрахунок скаляра з нової точки за замовчуванням вважається завданням дискретного логарифмування.

Зі сказаного зрозуміло, що \(r\) точка на кривій, а \(s\) iскаляр. Розглянемо групу власників підпису, представлених \(x_{sum} = x_1 + ... + x_n\) з nonces \(k_{sum} = k_1 + ... + k_n\). Відкритий ключ приватної скалярної суми буде: \(y = x_{sum} G\). Підпис для цих сум (від усіх учасників групи) буде: \(r' = k_{sum} G s' = k_{sum} - h x_{sum}\). TЩоб згенерувати цей підпис, всім учасникам доведеться заздалегідь поділитися своїм приватним ключем і nonces. Вочевидь, ми хочемо уникнути цього, тому створюємо частковий підпис для кожного з учасників. \(r_n = k_1 G + ... + k_n G = r'\) (сума відкритих nonce точок, які учасники можуть вільно публікувати в індивідуальному порядку) \(s_n = k_n - h x_n\). Підставляючи це в загальні формули для підписів і використовуючи точкове чи скалярне додавання: \(r = r_n = r'\) (те ж, що і вище) \(s = s_1 + ... + s_n = s'\) (просте скалярне додавання; вірно, що \((k_1 - h x_1) + ... + (k_n - h x_n) = s_1 + ... + s_n = s')\). Виконання підпису m-of-n  є нетривіальним. Була висловлена пропозиція, щоб для таких випадків використовувалось дерево Меркла, яке містить всі можливі суми відкритих ключів для \(m\)учасників, генеруючи підпис розміром \(log(n)\)  [28].

---

## <i class="fa fa-book"></i> Посилання 

[^1]: Wuille P. 2015. [Tree signatures: Multisig on steroids using tree signatures](https://decred.org/research/wuille2015.pdf).
