<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://docs.decred.org/research/schnorr-signatures/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Schnorr Signatures - dcrdocs</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/style.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">dcrdocs</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../getting-started/overview/">Overview</a>
</li>

                    
                        
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">User Guides</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../getting-started/user-guides/windows/">Windows</a>
</li>

        
            
<li >
    <a href="../../getting-started/user-guides/linux/">Linux</a>
</li>

        
            
<li >
    <a href="../../getting-started/user-guides/osx/">OSX</a>
</li>

        
            
<li >
    <a href="../../getting-started/user-guides/web/">Web</a>
</li>

        
    </ul>
  </li>

                    
                        
<li >
    <a href="../../getting-started/obtaining-dcr/">Obtaining DCR</a>
</li>

                    
                        
<li >
    <a href="../../getting-started/using-the-block-explorer/">Using the Block Explorer</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Mining <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../mining/overview/">Overview</a>
</li>

                    
                        
<li >
    <a href="../../mining/proof-of-stake/">Proof-of-stake (PoS)</a>
</li>

                    
                        
<li >
    <a href="../../mining/proof-of-work/">Proof-of-work (PoW)</a>
</li>

                    
                        
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">User Guides</a>
    <ul class="dropdown-menu">
        
            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">cgminer</a>
    <ul class="dropdown-menu">
        
            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Pool-Mining</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../mining/proof-of-work/pool-mining/cgminer/linux/">Linux Guide</a>
</li>

        
            
<li >
    <a href="../../mining/proof-of-work/pool-mining/cgminer/windows/">Windows Guide</a>
</li>

        
    </ul>
  </li>

        
            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Solo-Mining</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../mining/proof-of-work/solo-mining/cgminer/linux/">Linux Guide</a>
</li>

        
            
<li >
    <a href="../../mining/proof-of-work/solo-mining/cgminer/windows/">Windows Guide</a>
</li>

        
    </ul>
  </li>

        
    </ul>
  </li>

        
    </ul>
  </li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">FAQ <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../faq/overview/">Overview</a>
</li>

                    
                        
<li >
    <a href="../../faq/general/">General</a>
</li>

                    
                        
<li >
    <a href="../../faq/configuration/">Configuration</a>
</li>

                    
                        
<li >
    <a href="../../faq/wallets-and-seeds/">Wallets and Seeds</a>
</li>

                    
                        
<li >
    <a href="../../faq/web-client/">Web Client</a>
</li>

                    
                        
<li >
    <a href="../../faq/blocks/">Blocks</a>
</li>

                    
                        
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Proof-of-stake</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../faq/proof-of-stake/solo-mining/">Solo Mining</a>
</li>

        
            
<li >
    <a href="../../faq/proof-of-stake/buying-tickets-and-fees/">Buying Tickets and Fees</a>
</li>

        
            
<li >
    <a href="../../faq/proof-of-stake/voting-tickets/">Voting Tickets</a>
</li>

        
            
<li >
    <a href="../../faq/proof-of-stake/stake-pools/">Stake Pools</a>
</li>

        
    </ul>
  </li>

                    
                        
<li >
    <a href="../../faq/proof-of-work-mining/">Proof-of-work Mining</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Advanced <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../advanced/overview/">Overview</a>
</li>

                    
                        
<li >
    <a href="../../advanced/storing-login-details/">Storing Login Details</a>
</li>

                    
                        
<li >
    <a href="../../advanced/program-options/">Program Options</a>
</li>

                    
                        
<li >
    <a href="../../advanced/block-header-specifications/">Block Header Specifications</a>
</li>

                    
                        
<li >
    <a href="../../advanced/verifying-binaries/">Verifying Binaries</a>
</li>

                    
                        
<li >
    <a href="../../advanced/deleting-your-wallet/">Deleting Your Wallet</a>
</li>

                    
                        
<li >
    <a href="../../advanced/dcrctl-usage/">Advanced dcrctl usage</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Research <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../overview/">Overview</a>
</li>

                    
                        
<li >
    <a href="../hybrid-design/">Hybrid Design</a>
</li>

                    
                        
<li >
    <a href="../decentralized-stake-pooling/">Decentralized Stake Pooling</a>
</li>

                    
                        
<li >
    <a href="../elliptic-curve-signature-algorithms/">Elliptic Curve Signature Algorithms</a>
</li>

                    
                        
<li >
    <a href="../blake-256-hash-function/">BLAKE-256 Hash Function</a>
</li>

                    
                        
<li >
    <a href="../script-extensions/">Script Extensions</a>
</li>

                    
                        
<li >
    <a href="../signature-script-isolation-and-fraud-proofs/">Signature Script Isolation and Fraud Proofs</a>
</li>

                    
                        
<li >
    <a href="../transaction-extensions/">Transaction Extensions</a>
</li>

                    
                        
<li class="active">
    <a href="./">Schnorr Signatures</a>
</li>

                    
                        
<li >
    <a href="../miscellaneous-improvements/">Miscellaneous Improvements</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../about/credits/">Credits</a>
</li>

                    
                        
<li >
    <a href="../../about/license/">License</a>
</li>

                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                <li >
                    <a rel="next" href="../transaction-extensions/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../miscellaneous-improvements/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/decred/dcrdocs">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#schnorr-signatures">Schnorr Signatures</a></li>
        
            <li><a href="#references"> References</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="schnorr-signatures"><strong>Schnorr Signatures</strong><a class="headerlink" href="#schnorr-signatures" title="Permanent link">&para;</a></h1>
<hr />
<p>Schnorr signatures have been proposed for Bitcoin. They have also been used extensively in other cryptocurrencies, such as Nxt and CryptoNote coins. In the simplest case, a Schnorr signature ECDSA cryptosystem can be described as follows:</p>
<ol>
<li>
<script type="math/tex">y = xG</script> where <script type="math/tex">y</script> is the public key point on the curve, <script type="math/tex">x</script> is the private scalar, <script type="math/tex">G</script> is the curve generator.</li>
<li>
<script type="math/tex">r = kG</script> where <script type="math/tex">r</script> is the point on the curve resulting from the multiplication of <script type="math/tex">k</script>, the nonce scalar, by the generator.</li>
<li>
<script type="math/tex">h = H(M || r)</script> where <script type="math/tex">H</script> is a secure hash function, <script type="math/tex">M</script> is the message (usually a 32 byte hash), and <script type="math/tex">r</script> is the encoded point previously described. <script type="math/tex">||</script> denotes concatenation.</li>
<li>
<script type="math/tex">s = k - hx</script> where <script type="math/tex">s</script> is the scalar denoted from <script type="math/tex">k - hx</script>.</li>
<li>The signature is <script type="math/tex">(r,s)</script>, and verification is simply <script type="math/tex">H(M || r) == hQ + sG</script>.</li>
</ol>
<p>In the above, multiplications by a capital letter (e.g., <script type="math/tex">kG</script>) are point multiplications by a scalar, and so always result in a point on the curve. Addition of these points results in another point. Additions and multiplications of scalars amongst themselves is the same as regular multiplication you would do with any integer. It&rsquo;s important to note that multiplying a point by a scalar is considered an irreversible step, because the calculation of the scalar from the new point defaults to the discrete logarithm problem.</p>
<p>From the above it is clear that <script type="math/tex">r</script> is a point on the curve, while <script type="math/tex">s</script> is a scalar. Consider the group of signers represented by <script type="math/tex">x_{sum} = x_1 + ... + x_n</script> with nonces <script type="math/tex">k_{sum} = k_1 + ... + k_n</script>. The public key for the private scalar sum would be: <script type="math/tex">y = x_{sum} G</script>. The signature for these sums (from all group participants) would be: <script type="math/tex">r' = k_{sum} G s' = k_{sum} - h x_{sum}</script>. To generate this signature all participants would have to share their private key and nonces beforehand. We want to obviously avoid this, so instead let us have each participant create a partial signature. <script type="math/tex">r_n = k_1 G + ... + k_n G = r'</script> (the sum of the public nonce points, which the participants may freely individually publish) <script type="math/tex">s_n = k_n - h x_n</script>. Substituting this into the general formulas for signatures and using point or scalar addition: <script type="math/tex">r = r_n = r'</script> (the same as above) <script type="math/tex">s = s_1 + ... + s_n = s'</script> (simple scalar addition; it must be true that <script type="math/tex">(k_1 - h x_1) + ... + (k_n - h x_n) = s_1 + ... + s_n = s')</script>. Doing an m-of-n signature is non-trivial. It has been suggested that a merkle tree containing all possible public key sums for <script type="math/tex">m</script> participants be used for these cases, generating a <script type="math/tex">log(n)</script> sized signature [28].</p>
<hr />
<h2 id="references"><strong><i class="fa fa-book"></i> References</strong><a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Wuille P. 2015. <a href="https://decred.org/research/wuille2015.pdf">Tree signatures: Multisig on steroids using tree signatures</a>.&#160;<a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
                <center>If you wish to improve this site, please <a href="https://github.com/decred/dcrdocs/issues/new"><i class="fa fa-github"></i> open an issue</a> or <a href="https://github.com/decred/dcrdocs/compare"><i class="fa fa-github"></i> send a pull request</a>.<br>dcrdocs v0.0.2. Decred Project 2016.</center>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>